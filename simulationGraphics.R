setwd("C:/Users/jntrcs/Desktop/Statistical\ Computation/DistributionProject")
source("burrFunctions.R")
#SimulationGraphics
load("Simulation-Results.RData")


#sim.results$mse$k$scenario1
#sim.results$mse$k$scenario2
#sim.results$mse$k$scenario3
pdf(file="BiasGraph.pdf", height=9, width=8)
par(mfrow=c(3,2))
par(omi = c(0, 0, .3, 0))
par(mar=c(4, 4.1,4.1,1.7))
n<-c(20,150,1000)
plot(sim.results$bias$c$scenario1[1,]~n,xaxt="n", type="l", xlim=c(0,1000), ylim=c(-.01,.4), main="c = 2",  ann=F)
axis(1, at = c(20,150,1000), labels=c(20,100,1000))
lines(sim.results$bias$c$scenario1[2,]~n, col="red")
lines(sim.results$bias$c$scenario1[3,]~n, col="blue")
abline(h=0, lty=2)
title(main="c=2")
title(main = "Bias Estimates under Different Scenarios", outer = TRUE)
legend("topright", legend=c("MLE", "Percentile Matching", "Bayes Estimator", "Unbiased"), lty=c(1,1,1,2),col=c("black","red","blue","black"))
mtext("n", 1, line = -1, outer = TRUE) 
mtext("Bias", 2, line = -1.5, outer = TRUE)

plot(sim.results$bias$k$scenario1[1,]~n, xaxt="n",type="l", xlim=c(0,1000), ylim=c(-.3,4), main="c = 2",  ann=F)
axis(1, at = c(20,150,1000), labels=c(20,100,1000))
title(main="k=8")
lines(sim.results$bias$k$scenario1[2,]~n, col="red")
lines(sim.results$bias$k$scenario1[3,]~n, col="blue")
abline(h=0, lty=2)

plot(sim.results$bias$c$scenario2[1,]~n,xaxt="n", type="l", xlim=c(0,1000), ylim=c(-.1,3.3), main="c = 2",  ann=F)
axis(1, at = c(20,150,1000), labels=c(20,100,1000))
title(main="c=3")
lines(sim.results$bias$c$scenario2[2,]~n, col="red")
lines(sim.results$bias$c$scenario2[3,]~n, col="blue")
abline(h=0, lty=2)

plot(sim.results$bias$k$scenario2[1,]~n,xaxt="n", type="l", xlim=c(0,1000), ylim=c(0,1.7), main="c = 2",  ann=F)
axis(1, at = c(20,150,1000), labels=c(20,100,1000))
title(main="k=7")
lines(sim.results$bias$k$scenario2[2,]~n, col="red")
lines(sim.results$bias$k$scenario2[3,]~n, col="blue")
abline(h=0, lty=2)
#par(mar=mar)
plot(sim.results$bias$c$scenario3[1,]~n,xaxt="n", type="l", xlim=c(0,1000), ylim=c(-.2,.8), main="c = 2",  ann=F)
axis(1, at = c(20,150,1000), labels=c(20,100,1000))
title(main="c=5")
lines(sim.results$bias$c$scenario3[2,]~n, col="red")
lines(sim.results$bias$c$scenario3[3,]~n, col="blue")
abline(h=0, lty=2)

plot(sim.results$bias$k$scenario3[1,]~n,xaxt="n", type="l", xlim=c(0,1000), ylim=c(0,2.2), main="c = 2",  ann=F)
axis(1, at = c(20,150,1000), labels=c(20,100,1000))
title(main="k=5")
lines(sim.results$bias$k$scenario3[2,]~n, col="red")
lines(sim.results$bias$k$scenario3[3,]~n, col="blue")
abline(h=0, lty=2)
dev.off()

pdf(file="MSEGraph.pdf", height=9, width=8)
par(mfrow=c(3,2))
par(omi = c(0, 0, .3, 0))
par(mar=c(4, 4.1,4.1,1.7))
n<-c(20,150,1000)
plot(sim.results$mse$c$scenario1[1,]~n, type="l", xlim=c(0,1000), xaxt="n",ylim=c(0,.7), main="c = 2",  ann=F)
axis(1, at = c(20,150,1000), labels=c(20,100,1000))
lines(sim.results$mse$c$scenario1[2,]~n, col="red")
lines(sim.results$mse$c$scenario1[3,]~n, col="blue")
title(main="c=2")
title(main = "MSE Estimates under Different Scenarios", outer = TRUE)
legend("topright", legend=c("MLE", "Percentile Matching", "Bayes Estimator"), lty=c(1,1,1),col=c("black","red","blue"))
mtext("n", 1, line = -1, outer = TRUE) 
mtext("MSE", 2, line = -1.5, outer = TRUE)

plot(sim.results$mse$k$scenario1[1,]~n, type="l", xaxt="n",xlim=c(0,1000), ylim=c(0, 36), main="c = 2",  ann=F)
axis(1, at = c(20,150,1000), labels=c(20,100,1000))
title(main="k=8")
lines(sim.results$mse$k$scenario1[2,]~n, col="red")
lines(sim.results$mse$k$scenario1[3,]~n, col="blue")

plot(sim.results$mse$c$scenario2[1,]~n, type="l", xaxt="n",xlim=c(0,1000), ylim=c(0,5), main="c = 2",  ann=F)
axis(1, at = c(20,150,1000), labels=c(20,100,1000))
title(main="c=3")
lines(sim.results$mse$c$scenario2[2,]~n, col="red")
lines(sim.results$mse$c$scenario2[3,]~n, col="blue")

plot(sim.results$mse$k$scenario2[1,]~n, type="l",xaxt="n", xlim=c(0,1000), ylim=c(0,2), main="c = 2",  ann=F)
axis(1, at = c(20,150,1000), labels=c(20,100,1000))
title(main="k=7")
lines(sim.results$mse$k$scenario2[2,]~n, col="red")
lines(sim.results$mse$k$scenario2[3,]~n, col="blue")
#par(mar=mar)
plot(sim.results$mse$c$scenario3[1,]~n, type="l",xaxt="n", xlim=c(0,1000), ylim=c(0,3), main="c = 2",  ann=F)
axis(1, at = c(20,150,1000), labels=c(20,100,1000))
title(main="c=5")
lines(sim.results$mse$c$scenario3[2,]~n, col="red")
lines(sim.results$mse$c$scenario3[3,]~n, col="blue")

plot(sim.results$mse$k$scenario3[1,]~n, type="l", xaxt="n",xlim=c(0,1000), ylim=c(0,5), main="c = 2",  ann=F)
axis(1, at = c(20,150,1000), labels=c(20,100,1000))
title(main="k=5")
lines(sim.results$mse$k$scenario3[2,]~n, col="red")
lines(sim.results$mse$k$scenario3[3,]~n, col="blue")
dev.off()
